<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Observe a specific cluster of interest — enr_obs_clust • FBCanalysis</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Observe a specific cluster of interest — enr_obs_clust"><meta property="og:description" content="Observe a specific cluster of interest of preporcessed extended and time
series data for overview and p-values."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FBCanalysis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Vignette.html">Develop and evaluate biomedical time series data clustering models based on Fluctuation Based Clustering (FBC)</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/MrMaximumMax/FBCanalysis/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Observe a specific cluster of interest</h1>
    <small class="dont-index">Source: <a href="https://github.com/MrMaximumMax/FBCanalysis/blob/HEAD/R/enrichment.R" class="external-link"><code>R/enrichment.R</code></a></small>
    <div class="hidden name"><code>enr_obs_clust.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Observe a specific cluster of interest of preporcessed extended and time
series data for overview and p-values.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">enr_obs_clust</span><span class="op">(</span><span class="va">ts.dat</span>, <span class="va">enrich</span>, <span class="va">clustno</span>, <span class="va">numeric</span>, <span class="va">categorical</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ts.dat</dt>
<dd><p>Processed data frame storing time series data and cluster assignments (also see function: <a href="add_clust2ts.html">add_clust2ts</a>)</p></dd>
<dt>enrich</dt>
<dd><p>Processed data frame storing enrichment data and cluster assignments (also see function: <a href="add_clust2enrich.html">add_clust2enrich</a>)</p></dd>
<dt>clustno</dt>
<dd><p>Cluster number of interest</p></dd>
<dt>numeric</dt>
<dd><p>Statistical test to be performed on continuous data</p></dd>
<dt>categorical</dt>
<dd><p>Statistical test to be performed on categorical data</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Terminal output presenting summary of time series and enrichment data with corresponding p-values</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>There are five techniques available to compute the p-value for continuous
or categorical data. In order to determine the relevant p-value inside a cluster
of interest, the data distribution within the cluster should be compared to the
data distribution outside the cluster. Prior to conducting the related probability
tests, one data processing step is performed, namely the construction of two data
distributions, one including only data included inside the cluster and another
comprising data from outside the cluster, for the purpose of comparing them.</p>
<p><strong>Mann-Whitney Test</strong> <em>(numeric = "wt")</em>
The Mannn-Whitney Test, sometimes referred to as the Wilcoxon rank-sum test (WRS),
is used to measure the significance of continuous variables within the observed
distribution. The WRS is used to test if the central tendency of two independent
samples is different. When the t-test for independent samples does not meet the
requirements, the WRS is used. The null hypothesis H0 states that the populations’
distributions are equal. H1 is the alternative hypothesis meaning that the
distributions are not equal. The test is consistent under the broader formulation
only when the following happens under H1.</p>
<p><strong>Analysis of Variance</strong> <em>(numeric = "anova")</em>
A further approach on determining significance for continuous distributions is the
Analysis of Variance (ANOVA). The perquisites for ANOVA are that samples are
sampled independently from each other. Additionally, variance homogeneity and
normal distribution must be given. A independent variable, consisting
of I categories should be given. H0 indicates that no differences in the means for
each I is given. It is used to compare two or more independent samples with
comparable or dissimilar sample sizes.</p>
<p><strong>Kruskall-Wallis test</strong> <em>(numeric = "kwt")</em>
With several samples are not normally distributed but also small sample sizes
and outliers, the Kruskall-Wallis test may be preferred. It is used to compare
two or more independent samples with comparable or dissimilar sample sizes.
It expands the WRS, which is only used to compare two groups. If the researcher
can make the assumption that all groups have an identically shaped and scaled
distribution, except for differences in medians, H0 is that all groups have
equal medians.</p>
<p><strong>Fisher’s exact test</strong> <em>(categorical = "fe")</em>
The hypergeometric test or Fisher’s exact test (FET) is used to analyze categorical
variables within the enriched data set. It is a statistical significance test
for contingency tables that is employed in the study of them. The test is helpful
for categorical data derived from object classification. It is used to assess
the importance of associations and inconsistencies between classes. The FET is
often used in conjunction with a 2 × 2 contingency table that represents two
categories for a variable, as well as assignment inside or outside of the cluster.
The p-value is calculated as if the table’s margins are fixed. This results in
a hypergeometric distribution of the numbers in the table cells under the null
hypothesis of independence. A hypergeometric distribution is a discrete probability
distribution that describes the probability of k successes, defined as random draws
for which the object drawn has a specified feature in n draws without replacement
from a finite population of size N containing exactly K objects with that feature,
where each draw is either successful or unsuccessful. The test is only practicable for
normal computations in the presence of a 2 × 2 contingency table. However, the
test’s idea may be extended to the situation of a m × n table in general.
Statistics programs provide a Monte Carlo approach for approximating the more
general case.</p>
<p><strong>Chi-Square test</strong> <em>(categorical = "chisq")</em>
Additionally, one may choose to do a Chi-Square test. This is a valid statistical
hypothesis test when the test statistic is normally distributed under the null
hypothesis. According to Pear- son, the difference between predicted and actual
frequencies in one or more categories of a contingency table is statistically
significant.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Siegel Sidney. Nonparametric statistics for the behavioral sciences.
The Journal of Nervous and Mental Disease, 125(3):497, 1957.</p>
<p>Kinley Larntz. Small-sample comparisons of exact levels for chi-squared
goodness-of-fit statistics. Journal of the American Statistical Association,
73(362):253–263, 1978.</p>
<p>Cyrus R Mehta and Nitin R Patel. A network algorithm for performing fisher’s
exact test in r× c contingency tables. Journal of the American Statistical Association,
78(382):427–434, 1983.</p>
<p>Aravind Subramanian, Pablo Tamayo, Vamsi K Mootha, Sayan Mukherjee, Benjamin
L Ebert, Michael A Gillette, Amanda Paulovich, Scott L Pomeroy, Todd R Golub,
Eric S Lander, et al. Gene set enrichment analysis: a knowledge-based approach
for interpreting genome-wide expression profiles. Proceedings of the National
Academy of Sciences, 102(43):15545–15550, 2005.</p>
<p>William H Kruskal and W Allen Wallis. Errata: Use of ranks in one-criterion variance
analysis. Journal of the American statistical Association, 48(264):907–911, 1953.</p>
<p>Kinley Larntz. Small-sample comparisons of exact levels for chi-squared goodness-
of-fit statistics. Journal of the American Statistical Association,
73(362):253–263, 1978.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">list</span> <span class="op">&lt;-</span> <span class="fu"><a href="patient_list.html">patient_list</a></span><span class="op">(</span></span>
<span class="r-in"><span class="st">"https://raw.githubusercontent.com/MrMaximumMax/FBCanalysis/master/demo/phys/data.csv"</span>,</span>
<span class="r-in">GitHub <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Patient PEF FEV1     date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  test_a   1   33 01.01.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  test_a   8   42 02.01.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  test_a  18   35 03.01.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  test_a  19   47 04.01.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  test_a  19   37 05.01.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       V1  V2   V3   V4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Patient PEF FEV1 date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1   2    3    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Which column represents the Patient_ID (please indicate number)?: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Which column represents the time (please indicate number)?: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Day:Month:Year 	 (1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Month:Day:Year 	 (2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Year:Month:Day 	 (3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Year:Day:Month 	 (4) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Day:Month:Year:Hour:Min (5) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Month:Day:Year:Hour:Min (6) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Year:Month:Day:Hour:Min (7) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Year:Day:Month:Hour:Min (8) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> What's the time format (please indicate number)?: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Twice daily 	 (1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Daily 		 (2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Twice a week 	 (3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Weekly 	 (4) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Twice a month 	 (5) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Monthly 	 (6) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Twice a quarter (7) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Quarterly 	 (8) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> What's the sampling frequency (please indicate number)?: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sample missing values from First quartile 	 (1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sample missing values from Third quartile 	 (2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sample missing values from 5th percentile 	 (3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sample missing values from 95th percentile 	 (4) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Interpolate missing values and apply L1 Regularization / Lasso Regression 		 (5) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Interpolate missing values and apply L2 Regulariztation / Ridge Regression 		 (6) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Interpolate missing values and apply Elastic Net on Regression and Regularization 	 (7) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Interpolate missing values by Linear Spline 	 (8) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Interpolate missing values by Cubic C2 Spline 	 (9) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Select measure for filling up NA values: </span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in `[.data.frame`(raw.data, , "Patient_ID"):</span> undefined columns selected</span>
<span class="r-in"><span class="co">#Sampling frequency is supposed to be daily</span></span>
<span class="r-in"><span class="va">clustering</span> <span class="op">&lt;-</span> <span class="fu"><a href="clust_matrix.html">clust_matrix</a></span><span class="op">(</span><span class="va">matrix</span>, method <span class="op">=</span> <span class="st">"kmeans"</span>, nclust <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in as.vector(x, mode):</span> cannot coerce type 'closure' to vector of type 'any'</span>
<span class="r-in"><span class="va">enr</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_enrich.html">add_enrich</a></span><span class="op">(</span><span class="va">list</span>,</span>
<span class="r-in"><span class="st">'https://raw.githubusercontent.com/MrMaximumMax/FBCanalysis/master/demo/enrich/enrichment.csv'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Patient_ID Gender    Location Age BMI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          b301      F        City  10  26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 patient_ID_32      F        City  12  27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     testpat_2      F        City  16  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          a100      F Countryside   8  20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          a300      M Countryside   7  22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          V1     V2       V3  V4  V5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Patient_ID Gender Location Age BMI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1      2        3   4   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Which column represents the Patient_ID (please indicate number)?: </span>
<span class="r-in"><span class="va">enr</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_clust2enrich.html">add_clust2enrich</a></span><span class="op">(</span><span class="va">enr</span>, <span class="va">clustering</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in as.data.frame(clustdat$Cls):</span> object 'clustering' not found</span>
<span class="r-in"><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_clust2ts.html">add_clust2ts</a></span><span class="op">(</span><span class="va">list</span>, <span class="va">clustering</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in do.call(rbind, plist):</span> second argument must be a list</span>
<span class="r-in"><span class="fu">enr_obs_clust</span><span class="op">(</span><span class="va">ts</span>, <span class="va">enr</span>, <span class="fl">1</span>, numeric <span class="op">=</span> <span class="st">"anova"</span>, categorical <span class="op">=</span> <span class="st">"fe"</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in dplyr::filter(enrich, Cluster == clustno):</span> Problem while computing `..1 = Cluster == clustno`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Caused by error:</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> object 'Cluster' not found</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Maximilian Koehler.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

