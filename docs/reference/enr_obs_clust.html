<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Observe a specific cluster of interest on preporcessed enrichment and time
series data for overview and p-values. The p-values are calculated by a
Wilcox Rank Sum test for continuous data and a Fisher's Exact Test for
categorical enrichment data."><title>Observe a specific cluster of interest on preporcessed enrichment and time
series data for overview and p-values. The p-values are calculated by a
Wilcox Rank Sum test for continuous data and a Fisher's Exact Test for
categorical enrichment data. — enr_obs_clust • FBCanalysis</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Observe a specific cluster of interest on preporcessed enrichment and time
series data for overview and p-values. The p-values are calculated by a
Wilcox Rank Sum test for continuous data and a Fisher's Exact Test for
categorical enrichment data. — enr_obs_clust"><meta property="og:description" content="Observe a specific cluster of interest on preporcessed enrichment and time
series data for overview and p-values. The p-values are calculated by a
Wilcox Rank Sum test for continuous data and a Fisher's Exact Test for
categorical enrichment data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">FBCanalysis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Vignette.html">Develop and evaluate biomedical time series data clustering models based on Fluctuation Based Clustering (FBC)</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MrMaximumMax/FBCanalysis/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Observe a specific cluster of interest on preporcessed enrichment and time
series data for overview and p-values. The p-values are calculated by a
Wilcox Rank Sum test for continuous data and a Fisher's Exact Test for
categorical enrichment data.</h1>
      <small class="dont-index">Source: <a href="https://github.com/MrMaximumMax/FBCanalysis/blob/HEAD/R/enrichment.R" class="external-link"><code>R/enrichment.R</code></a></small>
      <div class="d-none name"><code>enr_obs_clust.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Observe a specific cluster of interest on preporcessed enrichment and time
series data for overview and p-values. The p-values are calculated by a
Wilcox Rank Sum test for continuous data and a Fisher's Exact Test for
categorical enrichment data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">enr_obs_clust</span><span class="op">(</span><span class="va">ts.dat</span>, <span class="va">enrich</span>, <span class="va">clustno</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>ts.dat</dt>
<dd><p>Processed data frame storing time series data and cluster assignments (also see function: <a href="add_clust2ts.html">add_clust2ts</a>)</p></dd>
<dt>enrich</dt>
<dd><p>Processed data frame storing enrichment data and cluster assignments (also see function: <a href="add_clust2enrich.html">add_clust2enrich</a>)</p></dd>
<dt>clustno</dt>
<dd><p>Cluster number of interest</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Terminal output presenting summary of time series and enrichment data with corresponding p-values</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are two techniques to compute the p-value for continuous or
categorical data, according to past work. In order to determine the relevant
p-value inside a cluster of interest, the data distribution within the cluster
should be compared to the data distribution outside the cluster. Prior to
conducting the related probability tests, one data processing step is performed,
namely the construction of two data distributions, one including only data
included inside the cluster and another comprising data from outside the cluster,
for the purpose of comparing them.</p>
<p>The Mann-Whitney Test, sometimes referred to as the Wilcoxon rank-sum test (WRS),
is used to measure the significance of continuous variables within the observed
distribution. The WRS is used to test if the central tendency of two independent
samples is different. When the t-test for independent samples does not meet the
requirements, the WRS is used. The null hypothesis H0 states that the populations’
distributions are equal. H1 is the alternative hypothesis meaning that the
distributions are not equal. The test is consistent under the broader formulation
only when the following happens under H1.</p>
<p>The hypergeometric test or Fisher’s exact test (FET) is used to analyse categorical
variables within the enriched data set. It is a statistical significance test for
contingency tables that is employed in the study of them. The test is helpful for
categorical data derived from object classification. It is used to assess the
importance of associations and inconsistencies between classes. The FET is often
used in conjunction with a 2 × 2 contingency table that represents two categories
for a variable, as well as assignment inside or outside of the cluster. The p-value
is calculated as if the table’s margins are fixed. This results in a hypergeometric
distribution of the numbers in the table cells under the null hypothesis of
independence. A hypergeometric distribution is a discrete probability distribution
that describes the probability of k successes, defined as random draws for which
the object drawn has a specified feature in n draws without replacement from a
finite population of size N containing exactly K objects with that feature, where
each draw is either successful or unsuccessful. The test is only practicable for
normal computations in the presence of a 2 × 2 contingency table. However, the
test’s idea may be extended to the situation of a m × n table in general.
Statistics programs provide a Monte Carlo approach for approximating the more
general case.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Siegel Sidney. Nonparametric statistics for the behavioral sciences.
The Journal of Nervous and Mental Disease, 125(3):497, 1957.</p>
<p>Kinley Larntz. Small-sample comparisons of exact levels for chi-squared
goodness-of-fit statistics. Journal of the American Statistical Association,
73(362):253–263, 1978.</p>
<p>Cyrus R Mehta and Nitin R Patel. A network algorithm for performing fisher’s
exact test in r× c contingency tables. Journal of the American Statistical Association,
78(382):427–434, 1983.</p>
<p>Aravind Subramanian, Pablo Tamayo, Vamsi K Mootha, Sayan Mukherjee, Benjamin
L Ebert, Michael A Gillette, Amanda Paulovich, Scott L Pomeroy, Todd R Golub,
Eric S Lander, et al. Gene set enrichment analysis: a knowledge-based approach
for interpreting genome-wide expression profiles. Proceedings of the National
Academy of Sciences, 102(43):15545–15550, 2005.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">list</span> <span class="op">&lt;-</span> <span class="fu"><a href="patient_list.html">patient_list</a></span><span class="op">(</span></span>
<span class="r-in"><span class="st">"https://raw.githubusercontent.com/MrMaximumMax/FBCanalysis/master/demo/phys/data.csv"</span>,</span>
<span class="r-in">GitHub <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Patient PEF FEV1     date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  test_a   1   33 01.01.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  test_a   8   42 02.01.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  test_a  18   35 03.01.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  test_a  19   47 04.01.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  test_a  19   37 05.01.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       V1  V2   V3   V4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Patient PEF FEV1 date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1   2    3    4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Which column represents the Patient_ID (please indicate number)?: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Which column represents the time (please indicate number)?: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Day:Month:Year 	 (1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Month:Day:Year 	 (2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Year:Month:Day 	 (3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Year:Day:Month 	 (4) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Day:Month:Year:Hour:Min (5) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Month:Day:Year:Hour:Min (6) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Year:Month:Day:Hour:Min (7) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Year:Day:Month:Hour:Min (8) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> What's the time format (please indicate number)?: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Twice daily 	 (1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Daily 		 (2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Twice a week 	 (3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Weekly 	 (4) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Twice a month 	 (5) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Monthly 	 (6) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Twice a quarter (7) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Quarterly 	 (8) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> What's the sampling frequency (please indicate number)?: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sample missing values from top quantile 	 (1) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Sample missing values with bottom quantile 	 (2) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Interpolate missing values and apply L1 Regularization / Lasso Regression (3) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Interpolate missing values and apply L2 Regulariztation / Ridge Regression (4) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Interpolate missing values and apply Elastic Net on Regression and Regularization (5) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Interpolate missing values by Linear Spline (6) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Interpolate missing values by Cubic C2 Spline (7) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Select measure for filling up NA values: </span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in `[.data.frame`(raw.data, , "Patient_ID"):</span> undefined columns selected</span>
<span class="r-in"><span class="co">#Sampling frequency is supposed to be daily</span></span>
<span class="r-in"><span class="va">clustering</span> <span class="op">&lt;-</span> <span class="fu"><a href="clust_matrix.html">clust_matrix</a></span><span class="op">(</span><span class="va">matrix</span>, method <span class="op">=</span> <span class="st">"kmeans"</span>, nclust <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in as.vector(x, mode):</span> cannot coerce type 'closure' to vector of type 'any'</span>
<span class="r-in"><span class="va">enr</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_enrich.html">add_enrich</a></span><span class="op">(</span><span class="va">list</span>,</span>
<span class="r-in"><span class="st">'https://raw.githubusercontent.com/MrMaximumMax/FBCanalysis/master/demo/enrich/enrichment.csv'</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Patient_ID Gender    Location Age BMI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1          b301      F        City  10  26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 patient_ID_32      F        City  12  27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     testpat_2      F        City  16  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4          a100      F Countryside   8  20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          a300      M Countryside   7  22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          V1     V2       V3  V4  V5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Patient_ID Gender Location Age BMI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           1      2        3   4   5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Which column represents the Patient_ID (please indicate number)?: </span>
<span class="r-in"><span class="va">enr</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_clust2enrich.html">add_clust2enrich</a></span><span class="op">(</span><span class="va">enr</span>, <span class="va">clustering</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in as.data.frame(clustdat$Cls):</span> object 'clustering' not found</span>
<span class="r-in"><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_clust2ts.html">add_clust2ts</a></span><span class="op">(</span><span class="va">list</span>, <span class="va">clustering</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in do.call(rbind, plist):</span> second argument must be a list</span>
<span class="r-in"><span class="fu">enr_obs_clust</span><span class="op">(</span><span class="va">ts</span>, <span class="va">enr</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in dplyr::filter(enrich, Cluster == clustno):</span> Problem while computing `..1 = Cluster == clustno`.</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="font-weight: bold;">Caused by error:</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> object 'Cluster' not found</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Maximilian Koehler.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

